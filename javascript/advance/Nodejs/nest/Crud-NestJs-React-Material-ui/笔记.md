## [Nest.js](https://nestjs.bootcss.com/)
> 1. NestJS 是一个用于构建<font color=red>高效，可扩展</font>Nodejs 服务端应用程序的开发框架
> 2. 它利用Javascript渐近增强的能力，并且全面使用<font color=red>Typescript</font>,并且结合了<font color=red>OOP(面向对象编程)</font>，<font color=red>FP（函数编程）</font>和<font color=red>FRP（函数响应式编程）</font>
> 3. 底层，Nest构建在强大的HTTP服务器上， 例如<font color=red>Express(默认)</font>，并且可以通过配置从而使用<font color=red>Fastify</font>
> 4. NestJS 在常见的NodeJS框架(Express, fastify)之上提高了一个抽象级别，但仍然向开发者直接爆了了底层的API，从而使得开发者，可以自由的适用底层平台的第三方框架
1. 入口文件
```ts
import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  app.enableCors();
  await app.listen(5000);
}
bootstrap();

```

2. Module 
```ts
import { Module } from '@nestjs/common';
import { CatsController } from './cats.controller';
import { CatsService } from './cats.service';

@Module({
  imports: [
    ProductsModule,
    MongooseModule.forRoot('mongodb://localhost:27017/nest-blog-project', { useNewUrlParser: true })
  ],
  controllers: [CatsController],
  providers: [CatsService],
  exports: [CatsService]
})
export class CatsModule {}

```

3. service 
```ts
@Injectable()
export class AppService {
  getHello(): string {
    return 'Hello World!';
  }
}

```

4. controller
```ts

@Controller('products')
export class ProductsController {
    constructor(
        private productsService: ProductsService
    ) {}
    
    // Um pelo id
    @Get('product/:productID')
    async getProduct(@Res() res, @Param('productID', new ValidateObjectId()) productID) {
        const product = await this.productsService.getProduct(productID);
        if (!product) {
            throw new NotFoundException('O produto não existe!');
        }
        return res.status(HttpStatus.OK).json(product);
    }

    @Put('/edit')
    async editProduct(@Res() res, @Query('productID', new ValidateObjectId()) productID, @Body() createProductDTO: CreateProductDTO) {
        const editedProduct = await this.productsService.editProduct(productID, createProductDTO)
        if (!editedProduct) {
            throw new NotFoundException('O produto não existe!')
        }
        return res.status(HttpStatus.OK).json(
            {
                message: 'O producto foi actualizado com sucesso!',
                product: editedProduct
            }
        )
    }   
 
}
```

5. pipeTransform
```ts
import { Injectable, PipeTransform, ArgumentMetadata, BadRequestException } from "@nestjs/common";
import * as mongoose from 'mongoose';

@Injectable()
export class ValidateObjectId implements PipeTransform<string> {
    async transform(value: string, metadata: ArgumentMetadata) {
        const isValid = mongoose.Types.ObjectId.isValid(value)
        if (!isValid) {
            throw new BadRequestException('ID Invalido')
        }
        return value;
    }
}
```
6. guard
```ts
import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common';
import { Observable } from 'rxjs';

@Injectable()
export class RolesGuard implements CanActivate {
  canActivate(
    context: ExecutionContext,
  ): boolean | Promise<boolean> | Observable<boolean> {
    return true;
  }
}
```
```ts

@Controller('cats')
@UseGuards(RolesGuard)
export class CatsController {}
```